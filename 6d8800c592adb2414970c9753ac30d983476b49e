{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a9898c0e_cbad3e41",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 144,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T12:41:43Z",
      "side": 1,
      "message": "(I know that this conflicts with the comment on \"too many ways to calculate a css variable value\")\n\nWDYT of moving the whole logic to `CSSMatchedStyles` as a function `computeCSSVariableFully` (or something along the lines), test it inside `CSSMatchedStyles_test` and use here?\n\nHaving the logic for computing a CSS variable inside this feels a bit out of place. WDYT?",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ad02132f_7f474faf",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 144,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-15T13:02:47Z",
      "side": 1,
      "message": "See the followup CL https://crrev.com/c/5197852 for more detail, but the idea is to eventually use matcher logic to really compute variable values. As of now, that has to live here instead of in CSSMatchedStyles (very likely subject to change if we pursue using matcher logic for the general compuations we do in CSSMatchedStyles). NB: `computeValue` itself uses regex to match vars in the value.",
      "parentUuid": "a9898c0e_cbad3e41",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9a465002_917f3c8a",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 144,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T13:19:12Z",
      "side": 1,
      "message": "Ah I see, I\u0027ll look into the followup CL and then if I have comments, I\u0027ll add to the followup CL :)",
      "parentUuid": "ad02132f_7f474faf",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0681b315_fe782780",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 156,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T12:41:43Z",
      "side": 1,
      "message": "I wonder for which case this can happen; and just to make sure, for the case that `fallbackHtml` exists; are we returning the correct nodes as it reads like `var(--var-name), \u003cfallback-html\u003e)`. Maybe we need to remove the `)` at the end of the `document.createTextNode`.\n\nFor this case, it might also be okay to just return the text node with full text; WDYT?\n\n---\n\nIn addition to that, can we add a test case for this too?",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bd50e046_1b2c317d",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 156,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-15T17:18:40Z",
      "side": 1,
      "message": "Nice catch, simplified it a bit! I believe this is effectively dead in practice since computedSingleValue is null if there\u0027s no node cascade for the given style or it hasn\u0027t been initialized. Is that path worthy of a test?",
      "parentUuid": "0681b315_fe782780",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b277de8b_4c567b15",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 163,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T12:41:43Z",
      "side": 1,
      "message": "I\u0027m getting quite confused with these different ways of computing the CSS variable. We have 4 now:\n* `computeCSSVariable`\n* `computeSinglevariableValue`\n* `computeValue`\n* and the one in the `VariableRenderer`s `computedText()`.\n\nI wonder if we can consolidate them somehow. (you\u0027ve mentioned that replacing it with the machinery in matcher is in plans, still wanted to mention ðŸ˜…)",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "de516a09_a70794e4",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 163,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-15T13:02:47Z",
      "side": 1,
      "message": "The distinction is super subtle and the naming is not the most obvious.\n `computeCSSVariable` finds the definition of --a and computes its value.\n `computeSingleVariableValue` computes the value of a var() expression\n `computeValue` computes the value of a generic property value which may include var expressions.",
      "parentUuid": "b277de8b_4c567b15",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "46b601f1_5c3eefb9",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 163,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T13:19:12Z",
      "side": 1,
      "message": "Ah I see, thanks for the explanation! :)",
      "parentUuid": "de516a09_a70794e4",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1a681eff_5f3e25d1",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 191,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T12:41:43Z",
      "side": 1,
      "message": "It seems like currently we don\u0027t handle the interaction between color swatch in fallback html and the var swatch as changing the value in the fallback\u0027s color swatch resets after the change is committed.\n\nEither we should not show the color swatch for the fallback or handle the interaction there.",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a4d277f_cb1b5019",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 191,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-15T13:02:47Z",
      "side": 1,
      "message": "Do you have a testcase/example?",
      "parentUuid": "1a681eff_5f3e25d1",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "65ff0969_064e2a8b",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 191,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T13:19:12Z",
      "side": 1,
      "message": "There are two things I think:\n\nFirst, edits are not reflected in the variable:\n`background-color: var(--non-existent, red)`. If you change the color red from the fallback\u0027s color swatch, nothing changes on the page.\n\nSecond, color swatch is not shown for the variable itself but only for the fallback (though not sure about the expected behavior here)\n`background-color: var(--non-existent, var(--non-existent, red))`",
      "parentUuid": "7a4d277f_cb1b5019",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cc905afd_ef4bed23",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 191,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-15T17:18:40Z",
      "side": 1,
      "message": "Both are consequences of us not heaving dealt with fallbacks before.\na) We don\u0027t propagate color updates between color swatches like we do for color mix, there aren\u0027t any \"dependent\" swatches. Hence the var and fallback swatches are unrelated to each other. \nb) CSSMatchedStyles\u0027 value computation doesn\u0027t deal with fallbacks as you mentioned, so the outermost var doesn\u0027t see it\u0027s fallback value as \"red\".\n\nI should probably address a) as a followup, I think I can make b) work with the computed text machinery in the dependent CL, WDYT?",
      "parentUuid": "65ff0969_064e2a8b",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dd7ee1bb_27685be8",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 191,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-16T13:24:07Z",
      "side": 1,
      "message": "Fixed both now. a) is with the caveat that parent swatches aren\u0027t updated while the color picker is open, but they refresh once the color is actually updated.",
      "parentUuid": "cc905afd_ef4bed23",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f6bef0ab_b8328c96",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 210,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T12:41:43Z",
      "side": 1,
      "message": "I think we\u0027re using `#getRegisteredPropertyDetails` in `innerUpdateTitle` too, so it doesn\u0027t seem like it will go away from `treeElement`. Instead of duplicating it here, can we use the one on the `treeElement`?\n\nThis applies to `getVariablePopoverContents` too.",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c38eadc9_5b540edc",
        "filename": "front_end/panels/elements/StylePropertyTreeElement.ts",
        "patchSetId": 14
      },
      "lineNbr": 210,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-15T17:18:40Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f6bef0ab_b8328c96",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b17fc582_72e5fc27",
        "filename": "test/unittests/front_end/panels/elements/PropertyParser_test.ts",
        "patchSetId": 14
      },
      "lineNbr": 385,
      "author": {
        "id": 1524702
      },
      "writtenOn": "2024-01-15T12:41:43Z",
      "side": 1,
      "message": "Should we also assert on the other parts of the match like `name` and `fallback` as we use them in `VariableRenderer` itself?",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6976bb70_73c94e19",
        "filename": "test/unittests/front_end/panels/elements/PropertyParser_test.ts",
        "patchSetId": 14
      },
      "lineNbr": 385,
      "author": {
        "id": 1372423
      },
      "writtenOn": "2024-01-15T17:18:40Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b17fc582_72e5fc27",
      "revId": "6d8800c592adb2414970c9753ac30d983476b49e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}